// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL")
}

model User {
  id            Int      @id @default(autoincrement())
  email         String   @unique
  name          String
  password      String
  phone_number  String
  refresh_token String?
  role          Role     @default(WORKER)
  department_id Int
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt

  Department Department @relation(fields: [department_id], references: [id])
}

model Supplier {
  id           Int      @id @default(autoincrement())
  name         String
  phone_number String
  email        String
  address      String
  created_at   DateTime @default(now())
  updated_at   DateTime @updatedAt
  Asset        Asset[]
}

model Asset {
  id          Int      @id @default(autoincrement())
  name        String
  description String
  asset_code  String
  entry_time  DateTime
  entry_price Int
  supplier_id Int
  status      StatusAsset
  condition   ConditionAsset
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt

  Supplier        Supplier          @relation(fields: [supplier_id], references: [id])
  AssetDepartment AssetDepartment[]
}

model Department {
  id      Int    @id @default(autoincrement())
  name    String
  address String

  created_at      DateTime          @default(now())
  updated_at      DateTime          @updatedAt
  User            User[]
  AssetDepartment AssetDepartment[]
}

model AssetDepartment {
  id            Int      @id @default(autoincrement())
  asset_id      Int
  department_id Int
  created_at    DateTime @default(now())
  updated_at    DateTime @updatedAt

  Asset      Asset      @relation(fields: [asset_id], references: [id])
  Department Department @relation(fields: [department_id], references: [id])
}

enum Role {
  ADMIN
  WORKER
  MANAGER
}

enum StatusAsset {
  USED
  READY_TO_USE
  MAINTENANCE
}

enum ConditionAsset {
  GOOD
  BAD
  BROKEN
}